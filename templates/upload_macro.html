{% extends "base.html" %}
{% block content %}

<div class="container mt-5">
    <h2>Upload Macroeconomic Analysis</h2>
    <form method="POST" enctype="multipart/form-data" id="uploadForm">
        <div class="form-group">
            <label for="ticker">Ticker (uppercase):</label>
            <input type="text" class="form-control" id="ticker" name="ticker" required>
        </div>
        <div class="form-group">
            <label for="content">Macroeconomic Analysis (Text):</label>
            <textarea class="form-control" id="content" name="content" rows="10"></textarea>
        </div>
        <div class="form-group">
            <label for="files">Or Upload Files:</label>
            <input type="file" class="form-control-file" id="files" name="files" multiple>
        </div>
        <button type="submit" class="btn btn-primary">Upload</button>
    </form>
    <div id="message" class="mt-3"></div>
</div>

<script>
document.getElementById('uploadForm').addEventListener('submit', function(e) {
    e.preventDefault();
    var formData = new FormData(this);
    fetch('/upload_macro', {
        method: 'POST',
        body: formData
    }).then(response => response.json())
    .then(data => {
        document.getElementById('message').innerHTML = data.message.replace(/\n/g, '<br>');
        if (data.success) {
            // Optionally redirect or perform other actions on success
        }
    });
});
</script>

{% endblock %}