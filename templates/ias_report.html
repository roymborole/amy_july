{% extends "base.html" %}
{% block head %}
{{ super() }}
<head>
<script src="{{ url_for('static', filename='js/search_module.js') }}"></script>
<title>Technical Analysis Report - {{ asset_name }}</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/tooltips.css') }}">
<link href="https://fonts.googleapis.com/css2?family=Anton:wght@300;400;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Anton&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/static/css/styles.css">
<script src="{{ url_for('static', filename='js/tooltips.js') }}"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
</head>
<style>
    h1, h2 {
        font-family: 'Anton', sans-serif;
        text-align: center;
    }

    h1 {
        font-family: 'Anton', sans-serif;
        font-size: 60px;
        text-align: center;
        text-transform: uppercase;
    }

    h2 {
        font-size: 20px;
        margin-top: 30px;
        text-align: center;

    }

    h3 {
        font-family: 'Anton', sans-serif;
        font-size: 30px;
        text-align: center;
        font-weight: bold;
    }
    .description {
        font-family: 'Roboto', sans-serif;
        font-size: 15px;
        text-align: center;
    }
    .button-container {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 20px;
        margin: 30px 0;
    }

    .btn {
        font-family: 'Roboto', sans-serif;
        color: white;
        padding: 15px 25px;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-weight: bold;
        text-decoration: none;
        display: inline-block;
        font-size: 18px;  
        transition: all 0.3s ease;  
    }
  
    .btn-email {
        background-color: #E2C100;
        color: white;
    }
    
    .btn-news {
        background-color: #FFBD59;
        color: white;
    }
    
    .btn-compare {
        background-color: #FF9A00;
        color: white;
    }
    
    .btn-subscribe {
        background-color: #FF5757;
        color: white;
    }
    
    .btn:hover {
        opacity: 0.8;
        transform: scale(1.05); 
    }
    
    .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }
    
    .popup {
        background-color: white;
        padding: 20px;
        border-radius: 5px;
        text-align: center;
    }

    .stat-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        margin-bottom: 20px;
    }

    
    .stat-box {
        flex: 1 1 calc(33.333% - 20px);
        margin: 10px;
        min-width: 200px;
        background-color: #C1FF72;
        border-radius: 10px;
        padding: 15px;
        text-align: center;
        color: black;
        }
    .stat-label {
        font-family: 'Roboto', sans-serif;
        font-size: 14px;
        font-weight: bold;
        color: black;
        margin-bottom: 5px;
        margin-top: 5px;
    }
    .stat-value {
        font-family: 'Roboto', sans-serif;
        font-size: 18px;
        font-weight: bold;
        color: black;
    }

    .table-container {
        display: flex;
        justify-content: center;
    }

    .custom-table {
        border-collapse: collapse;
        width: 80%;
        max-width: 800px;
        margin: 20px 0;
    }
    .custom-table th, .custom-table td {
        border: 1px solid white;
        padding: 10px;
        text-align: left;
        font-family: 'Roboto', sans-serif;
        color: black;
    }
    .custom-table th, .custom-table td:first-child {
        background-color: #C1FF72;
    }
    .custom-table tr:not(:first-child) td:not(:first-child) {
        background-color: #D9D9D9;
    }

    .performance-table {
        margin: 0 auto;
        border-collapse: collapse;
        width: 80%;
    }
    .performance-table th, .performance-table td {
        border: 1px solid white;
        padding: 10px;
        text-align: left;
        font-family: 'Roboto', sans-serif;
        color: black;
    }
    .performance-table th {
        background-color: #C1FF72;
    }
    .performance-table tr:not(:first-child) {
        background-color: #D9D9D9;
    }
    .chart {
        max-width: 100%;
        height: auto;
        margin: 20px 0;
        border-radius: 10px;
    }
</style>
{% endblock %}}
{% block content %}
<div class="container">
    <h1> Investment Analysis for ${data.company_name || ticker} (${ticker}) </h1>
    <canvas id="performanceChart"></canvas>
    <canvas id="priceHistoryChart"></canvas>
    <div id="ia-analysis-result"></div>
    <div id="raw-performance-data" style="display: none;"></div>
    <div id="raw-price-history-data" style="display: none;"></div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/ia_search_module.js') }}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const reportData = JSON.parse(localStorage.getItem('reportData'));
    const ticker = '{{ ticker }}';
    console.log("Report data:", reportData);  // Debug log
    console.log("Ticker:", ticker);  // Debug log
    if (reportData) {
        IASearchModule.displayMacroeconomicAnalysis(ticker, reportData);
    } else {
        alert('Report data not found. Please try generating the report again.');
        window.location.href = '/';
    }
});
</script>
{% endblock %}